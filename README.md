
## Ключевые особенности решения:

### 1. **Улучшенная подготовка данных**:
- Расширенные признаки пользователей (активность, статистики оценок)
- Расширенные признаки книг (популярность, разнообразие оценок, категории)
- Признаки взаимодействий (схожесть с историей, разница в рейтингах)

### 2. **Гибридная система**:
- **Множественные модели**: Popularity, Content-based, Collaborative Filtering, Гибридная
- **Сегментация пользователей**: new_user, active_user, power_user
- **Система генерации кандидатов**: Объединение рекомендаций от всех моделей
- **Ранжирование с MMR**: Баланс между релевантностью и разнообразием

### 3. **Нейросетевой подход (Two-Tower)**:
- Два тауэра для пользователей и книг
- Эмбеддинги и глубокие слои
- Обучение с негативными сэмплами
- Метрики качества: Accuracy, AUC

### 4. **Интегрированная система**:
- Взвешенное объединение всех моделей
- Оптимизация весов моделей
- Комплексная оценка (Precision, Recall, nDCG, Coverage, Diversity)

### 5. **Сквозной пайплайн**:
- Полностью автоматизированный процесс
- Возможность сохранения и загрузки
- Визуализация результатов
- Демонстрация рекомендаций

## Как запустить:

1. **Подготовка данных**:
```bash
# Убедитесь, что данные находятся в папке goodbooks-10k/
mkdir -p goodbooks-10k
# Поместите туда ratings.csv, books.csv, tags.csv, book_tags.csv
```

2. **Запуск пайплайна**:
```python
python recommendation_pipeline.py
```

3. **Использование сохраненного пайплайна**:
```python
system = IntegratedRecommenderSystem()
system.load_pipeline('recommendation_pipeline')
recommendations = system.recommend(user_id=1, top_n=10)
```

Это решение обеспечивает:
- **Ненулевые метрики** за счет объединения множества подходов
- **Масштабируемость** за счет модульной архитектуры
- **Качество рекомендаций** за счет гибридизации и нейросетей
- **Повторяемость** за счет сохранения пайплайна

Система автоматически адаптируется к разным типам пользователей и обеспечивает сбалансированные рекомендации с учетом как релевантности, так и разнообразия.
